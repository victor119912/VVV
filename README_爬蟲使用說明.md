# 🎫 Tixcraft 活動爬蟲使用說明

## 📋 概述
這個爬蟲程式能夠自動抓取拓元售票網站的活動資訊，並將資料儲存在JSON檔案中，每次執行時會自動更新和合併資料。

## 🚀 快速開始

### 執行爬蟲
```bash
python tixcraft_precision_field_scraper.py
```

## 📊 資料管理功能

### 自動資料更新
- ✅ **載入現有資料**：開始時自動讀取 `tixcraft_activities.json`
- ✅ **智慧合併資料**：以URL作為唯一識別符，自動去重複
- ✅ **保留歷史資料**：更新活動資訊而不遺失舊資料
- ✅ **統計資料更新**：自動計算成功率和活動總數

### 資料結構
```json
{
  "scrape_time": "2026-02-25 12:47:03",        // 資料庫建立時間
  "last_update": "2026-02-25 12:47:03",        // 最後更新時間
  "total_events": 43,                          // 資料庫總活動數  
  "success_count": 23,                         // 成功提取資料的活動數
  "success_rate": "53.5%",                     // 整體成功率
  "current_scrape_count": 106,                 // 本次爬取活動數
  "current_scrape_success": 106,               // 本次爬取成功數
  "events": [...]                              // 活動詳細資料
}
```

## 🎯 提取的資料欄位

每個活動包含以下6個核心欄位：

| 欄位 | 描述 | 提取規則 |
|-----|------|---------|
| 📅 `date` | 演出日期 | YYYY/MM/DD格式，長度<100字符 |
| ⏰ `time` | 演出時間 | 時間相關資訊 |
| 📍 `location` | 演出地點 | 包含場館關鍵詞（Legacy、Zepp、體育場等） |
| 💰 `price` | 活動票價 | 包含NT$或元的價格資訊 |  
| 🎟️ `sale_time` | 售票時間 | 售票開始時間 |
| 🏷️ `title` | 活動標題 | 完整活動名稱 |

## 📁 檔案說明

### 輸出檔案
- `tixcraft_activities.json` - 主要資料庫檔案（自動更新）
- `tixcraft_precision_field.log` - 執行日誌檔案

### 程式檔案
- `tixcraft_precision_field_scraper.py` - 主要爬蟲程式

## 🔄 資料更新流程

1. **載入現有資料** - 讀取 `tixcraft_activities.json`
2. **執行爬取** - 抓取最新的活動資訊  
3. **智慧合併** - 以URL為準，更新或新增活動
4. **重新編號** - 自動調整活動索引號碼
5. **統計更新** - 計算new成功率和活動總數
6. **儲存資料** - 更新JSON檔案

## ⚙️ 精確提取特色

### 欄位錯位解決
- 使用專門的正則表達式規則
- 日期：`\d{4}/\d{1,2}/\d{1,2}` + 長度限制
- 價格：`(NT\$|元).*\d` 包含貨幣符號
- 地點：關鍵詞匹配（館、中心、Legacy等）

### 資料清理
自動移除干擾符號：`;` `&nbsp;` `●` `👉`

## 📈 執行結果示例

```
=== 資料更新結果 ===
更新時間：2026-02-25 12:47:03
本次爬取：106 個活動
本次成功：106 個
資料庫總計：43 個活動  
整體成功率：53.5%
提取方法：precision_field_extraction
儲存檔案：tixcraft_activities.json

✅ 資料已成功更新到 tixcraft_activities.json
📊 總共管理 43 個活動資料
```

## 🎉 使用優勢

- 🔄 **自動化更新**：每次執行自動合併新舊資料
- 🚫 **防止重複**：URL去重複機制  
- 📊 **詳細統計**：追蹤成功率和資料品質
- 🎯 **精確提取**：專門的欄位分類規則
- 📝 **完整日誌**：詳細記錄執行過程

## ⚠️ 注意事項

- 程式會自動處理資料合併，無需手動管理
- 建議定期備份 `tixcraft_activities.json` 檔案
- 執行前確保網路連線正常
- 日誌檔案可用於除錯和監控

---

🎫 **開始爬取最新的活動資訊吧！**